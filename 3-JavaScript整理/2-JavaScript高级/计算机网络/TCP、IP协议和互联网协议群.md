
 TCP/IP协议族中有一个重要的概念是分层，TCP/IP协议按照层次分为以下四层：

    应用层、传输层、网络层、数据链路层。提到协议分层，通常会联想到OSI的七层协议经典架构，但是TCP/IP协议族的结构则稍有不同。如图所示

    TCP/IP协议族按照层次由上到下，层层包装。

（1）最上面的就是应用层了，这里面有http，ftp,等等我们熟悉的协议。

    TCP/IP的分层中，将OSI参考模型中的会话层、表示层和应用层的功能都集中到了应用程序中实现。

    TCP/IP应用的架构绝大多数属于客户端/服务器模型。

应用层的主要应用场景：

    浏览器和服务端之间通信所用的协议是HTTP协议，所传输数据的主要格式为HTML。

    发送电子邮件时用到的协议是SMTP。

    文件传输（FTP)

    远程登录常用TELNET与SSH两种协议。远程登录是指登录到远程的计算机上，使那台计算机上的程序得以运行的一种功能。

    网络管理（SNMP）

（2）第二层则是传输层，著名的TCP和UDP协议就在这个层次。

    传输层最主要的功能是能够让应用程序之间实现通信，并且定义了两种服务质量不同的协议，即：传输控制协议TCP和用户数据报协议UDP。

    TCP协议是一个面向连接的、可靠的协议。它可以保证两端通信主机之间的通信可达。在发送端，它负责把上层传送下来的字节流分成报文段并传递给下层。在接收端，它负责把收到的报文进行重组后递交给上层。TCP协议还要处理端到端的流量控制，以避免缓慢接收的接收方没有足够的缓冲区接收发送方发送的大量数据.

    UDP传送数据前并不与对方建立连接，对接收到的数据也不发送确认信号，发送端不知道数据是否会正确接收，当然也不用重发，所以说UDP是无连接的、不可靠的一种数据传输协议。

    UDP常用在分组数据较少或多播、广播通信以及视频通信等多媒体领域（即时通信）。

（3）第三层是网络层，IP协议就在这里，它负责对数据加上IP地址和其他的数据以确定传输的目标。

    也称作互联网层，是整个TCP/IP协议栈的核心。它的功能是把分组发往目标网络或主机。同时，为了尽快地发送分组，可能需要沿不同的路径同时进行分组传递。因此，分组到达的顺序和发送的顺序可能不同，这就需要上层必须对分组进行排序。

    网络层定义了分组格式和协议，即IP协议（Internet Protocol）。另外的还有ICMP协议（Internet互联网控制报文协议），以及IGMP协议（Internet组管理协议）。

    IP是一种网络层协议，提供的是一种不可靠的服务，它只是尽可能快地把分组从一端送到另一端，但是并不提供任何可靠性保证。同时被TCP和UDP使用。TCP和UDP的每组数据都通过端系统和每个中间路由器中的IP层在互联网中进行传输。

    ICMP是IP协议的附属协议。IP层用它来与其他主机或路由器交换错误报文和其他重要信息。

    IGMP是Internet组管理协议。它用来把一个UDP数据报多播到多个主机。

（4）第四层是叫数据链路层，也称作网络接口层，通常包括操作系统中的设备驱动程序和计算机中对应的网络接口卡。链路层为待传送的数据加入一个以太网协议头，并进行CRC编码，为最后的数据传输做准备。


+ 常见问题
1、TCP/IP协议通信的过程

通信的过程其实就对应着数据装包与拆包的过程。装包的过程，数据发送方每层不断地封装首部，添加一些信息用于传输，确保能传输到目的地。拆包的过程，数据接收方每层不断地拆除首部，得到最终传输的数据。（图例）
![图片](https://img-blog.csdn.net/20180510163847508)

每个分层中，都会对所发送的数据附加一个首部，在这个首部中包含了该层必要的信息，如发送的目标地址以及协议相关信息。通常，为协议提供的信息为包首部，所要发送的内容为数据。在下一层的角度看，从上一层收到的包全部都被认为是本层的数据。

2、如何建立TCP/IP连接？

TCP传输控制协议，是一个面向连接的协议。在TCP/IP协议中，TCP协议提供可靠的连接服务，连接是通过三次握手进行初始化的。所谓三次握手是指建立一个 TCP 连接时需要客户端和服务器端总共发送三个包以确认连接的建立。三次握手的目的是同步连接双方的序列号和确认号并交换 TCP窗口大小信息。

![图片](https://img-blog.csdn.net/2018051016392938)

3、为什么要三次握手？

为了防止已失效的连接请求报文段突然又传送到了服务端，因而产生错误。

三次握手是在安全可靠的基础上，握手次数最少的方案。两次握手并不能保证可靠性。四次握手又浪费了效率，当然，有的需要更高安全性的地方，是可以有N次握手协议的，但那是特殊情况。




原文链接: https://blog.csdn.net/weixin_40636513/article/details/80269951